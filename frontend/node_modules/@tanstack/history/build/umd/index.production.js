/**
 * @tanstack/history/src/index.ts
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).TanStackHistory={})}(this,(function(t){"use strict";const e="pushstate",o="popstate",n="beforeunload",r=t=>(t.preventDefault(),t.returnValue=""),i=()=>{removeEventListener(n,r,{capture:!0})};function a(t){let e=t.getLocation(),o=new Set,a=[];const c=()=>{e=t.getLocation(),o.forEach((t=>t()))},h=async e=>{if("undefined"!=typeof document&&a.length)for(let e of a){if(!await e())return void t.onBlocked?.(c)}e()};return{get location(){return e},subscribe:t=>(o.add(t),()=>{o.delete(t)}),push:(e,o)=>{o=s(o),h((()=>{t.pushState(e,o,c)}))},replace:(e,o)=>{o=s(o),h((()=>{t.replaceState(e,o,c)}))},go:e=>{h((()=>{t.go(e)}))},back:()=>{h((()=>{t.back()}))},forward:()=>{h((()=>{t.forward()}))},createHref:e=>t.createHref(e),block:t=>(a.push(t),1===a.length&&addEventListener(n,r,{capture:!0}),()=>{a=a.filter((e=>e!==t)),a.length||i()}),flush:()=>t.flush?.(),destroy:()=>t.destroy?.(),notify:c}}function s(t){return t||(t={}),{...t,key:u()}}function c(t){const n=t?.window??("undefined"!=typeof document?window:void 0),r=t?.createHref??(t=>t),i=t?.parseLocation??(()=>h(`${n.location.pathname}${n.location.search}${n.location.hash}`,n.history.state));let s,c=i();let u,f,l=!0;const d=()=>{l=!1,(()=>{u&&(n.history[u.isPush?"pushState":"replaceState"](u.state,"",u.href),u=void 0,f=void 0,s=void 0)})(),l=!0},p=(t,e,o,n)=>{const i=r(e);f||(s=c),c=h(e,o),u={href:i,state:o,isPush:u?.isPush||"push"===t},n(),f||(f=Promise.resolve().then((()=>d())))},y=()=>{c=i(),m.notify()};var g=n.history.pushState,v=n.history.replaceState;const m=a({getLocation:()=>c,pushState:(t,e,o)=>p("push",t,e,o),replaceState:(t,e,o)=>p("replace",t,e,o),back:()=>n.history.back(),forward:()=>n.history.forward(),go:t=>n.history.go(t),createHref:t=>r(t),flush:d,destroy:()=>{n.history.pushState=g,n.history.replaceState=v,n.removeEventListener(e,y),n.removeEventListener(o,y)},onBlocked:t=>{s&&c!==s&&(c=s,t())}});return n.addEventListener(e,y),n.addEventListener(o,y),n.history.pushState=function(){let t=g.apply(n.history,arguments);return l&&m.notify(),t},n.history.replaceState=function(){let t=v.apply(n.history,arguments);return l&&m.notify(),t},m}function h(t,e){let o=t.indexOf("#"),n=t.indexOf("?");return{href:t,pathname:t.substring(0,o>0?n>0?Math.min(o,n):o:n>0?n:t.length),hash:o>-1?t.substring(o):"",search:n>-1?t.slice(n,-1===o?void 0:o):"",state:e||{}}}function u(){return(Math.random()+1).toString(36).substring(7)}t.createBrowserHistory=c,t.createHashHistory=function(t){const e=t?.window??("undefined"!=typeof document?window:void 0);return c({window:e,parseLocation:()=>h(e.location.hash.split("#").slice(1).join("#")??"/",e.history.state),createHref:t=>`${e.location.pathname}${e.location.search}#${t}`})},t.createHistory=a,t.createMemoryHistory=function(t={initialEntries:["/"]}){const e=t.initialEntries;let o=t.initialIndex??e.length-1,n={key:u()};return a({getLocation:()=>h(e[o],n),pushState:(t,r)=>{n=r,e.push(t),o++},replaceState:(t,r)=>{n=r,e[o]=t},back:()=>{o--},forward:()=>{o=Math.min(o+1,e.length-1)},go:t=>{o=Math.min(Math.max(o+t,0),e.length-1)},createHref:t=>t})}}));
//# sourceMappingURL=index.production.js.map
